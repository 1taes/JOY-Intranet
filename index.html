<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joy Enter</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 로그인 모달 -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h2>로그인</h2>
            <div class="form-group">
                <label for="loginUid">고유번호</label>
                <input type="text" id="loginUid" placeholder="고유번호를 입력하세요" autofocus>
            </div>
            <div class="form-group">
                <label for="loginPassword">비밀번호</label>
                <input type="password" id="loginPassword" placeholder="비밀번호를 입력하세요">
                <div id="loginError" class="error-message"></div>
            </div>
            <div class="form-group checkbox-group">
                <input type="checkbox" id="autoLoginCheckbox">
                <label for="autoLoginCheckbox">자동 로그인</label>
            </div>
            <button id="submitLoginBtn" class="btn btn-primary">로그인</button>
            <button id="showRegisterBtn" class="btn btn-secondary" style="margin-top: 10px;">회원가입</button>
        </div>
    </div>

    <!-- 회원가입 모달 -->
    <div id="registerModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>회원가입</h2>
            <p>고유번호와 비밀번호를 입력하여 가입하세요.</p>
            <div class="form-group">
                <label for="registerUid">고유번호</label>
                <input type="text" id="registerUid" placeholder="고유번호를 입력하세요" autofocus>
            </div>
            <div class="form-group">
                <label for="registerName">이름</label>
                <input type="text" id="registerName" placeholder="이름을 입력하세요">
            </div>
            <div class="form-group">
                <label for="registerPassword">비밀번호</label>
                <input type="password" id="registerPassword" placeholder="비밀번호를 입력하세요">
            </div>
            <div class="form-group">
                <label for="registerPasswordConfirm">비밀번호 확인</label>
                <input type="password" id="registerPasswordConfirm" placeholder="비밀번호를 다시 입력하세요">
                <div id="registerError" class="error-message"></div>
            </div>
            <button id="submitRegisterBtn" class="btn btn-primary">가입 신청</button>
            <button id="cancelRegisterBtn" class="btn btn-secondary" style="margin-top: 10px;">취소</button>
        </div>
    </div>

    <!-- 메인 컨테이너 -->
    <div id="mainContainer" class="container" style="display: none;">
        <!-- 헤더 -->
        <header class="header">
            <div class="header-left">
                <img src="./image/f15f055d92b5e8ba.png" alt="JOY Entertainment" class="header-logo">
            </div>
            <div class="header-right">
                <span id="userInfo"></span>
                <span id="userRole" class="role-badge"></span>
                <a href="https://discord.com/channels/1022147541715918918/1397537845526265946" target="_blank" class="btn btn-primary btn-sm">내부공지</a>
                <a href="https://discord.gg/KcbmSTafnK" target="_blank" class="btn btn-secondary btn-sm">사설디코</a>
                <button id="logoutBtn" class="btn btn-secondary btn-sm">로그아웃</button>
            </div>
        </header>

        <!-- 탭 네비게이션 -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="home">홈</button>
            <button class="tab-btn" data-tab="transaction">거래보고서</button>
            <button class="tab-btn" data-tab="rp">RP보고서</button>
            <button class="tab-btn" data-tab="event">이벤트</button>
            <button class="tab-btn" data-tab="voucher">지원권</button>
            <button class="tab-btn" data-tab="orgchart">조직도</button>
            <button class="tab-btn" data-tab="search">검색</button>
            <button class="tab-btn senior-only" data-tab="statistics" style="display: none;">통계</button>
            <button class="tab-btn admin-only" data-tab="admin" style="display: none;">관리</button>
        </nav>

        <!-- 탭 콘텐츠 -->
        <main class="main-content">
            <!-- 홈 탭 -->
            <div id="home" class="tab-content active">
                <div id="weeklyStats" class="card">
                    <!-- 주별 통계 -->
                </div>
                
                <div class="card">
                    <h2>📅 일정 캘린더</h2>
                    <div class="calendar-header">
                        <button id="calendarPrevMonth" class="btn btn-secondary btn-sm">◀</button>
                        <h3 id="calendarTitle">2025년 1월</h3>
                        <button id="calendarNextMonth" class="btn btn-secondary btn-sm">▶</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- 캘린더 그리드 -->
                    </div>
                </div>
                
                <div class="card">
                    <h2>📋 선택된 날짜의 일정</h2>
                    <div id="selectedDateDisplay" class="selected-date">날짜를 선택하세요</div>
                    <div id="eventsList"></div>
                </div>
                
                <div class="card executive-only" style="display: none;">
                    <h2>📝 일정 추가</h2>
                    <form id="eventForm">
                        <div class="form-group">
                            <label for="eventDate">날짜</label>
                            <input type="date" id="eventDate" required>
                        </div>
                        <div class="form-group">
                            <label for="eventTitle">일정 제목</label>
                            <input type="text" id="eventTitle" placeholder="일정 제목을 입력하세요" required>
                        </div>
                        <div class="form-group">
                            <label for="eventDescription">상세 내용</label>
                            <textarea id="eventDescription" rows="3" placeholder="상세 내용을 입력하세요"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">일정 추가</button>
                        <div id="eventStatus" class="status-message"></div>
                    </form>
                </div>
            </div>

            <!-- 거래보고서 탭 -->
            <div id="transaction" class="tab-content">
                <div class="card">
                    <h2>거래보고서 작성</h2>
                    <form id="transactionForm">
                        <div class="form-group">
                            <label for="transactionDate">작성 날짜</label>
                            <input type="text" id="transactionDate" readonly>
                            <small>보고서 작성 날짜가 자동으로 기록됩니다</small>
                        </div>
                        <div class="form-group">
                            <label for="transactionItem">항목</label>
                            <select id="transactionItem" required>
                                <option value="">항목을 선택하세요</option>
                            </select>
                            <small>항목을 선택하면 금액이 자동으로 입력됩니다</small>
                        </div>
                        <div class="form-group">
                            <label for="transactionQuantity">갯수</label>
                            <input type="number" id="transactionQuantity" placeholder="1" min="1" value="1" required>
                        </div>
                        <div class="form-group">
                            <label for="transactionAmount">금액</label>
                            <input type="text" id="transactionAmount" placeholder="0" readonly>
                        </div>
                        <div class="form-group">
                            <label for="transactionPublicDeposit">공금액</label>
                            <input type="text" id="transactionPublicDeposit" placeholder="0" readonly>
                            <small>금액의 일정 비율이 자동 계산됩니다</small>
                        </div>
                        <div class="form-group">
                            <label for="transactionCustomerId">고유번호</label>
                            <input type="text" id="transactionCustomerId" placeholder="고유번호를 입력하세요" required>
                        </div>
                        <div class="form-group">
                            <label for="transactionCustomerName">이름 (선택사항)</label>
                            <input type="text" id="transactionCustomerName" placeholder="이름을 입력하세요">
                        </div>
                        <div class="form-group">
                            <label for="transactionContent">내용 (선택사항)</label>
                            <textarea id="transactionContent" rows="4" placeholder="추가 내용을 입력하세요"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">거래보고서 저장</button>
                        <div id="transactionStatus" class="status-message"></div>
                    </form>
                </div>
                
                <div class="card">
                    <h2>내 거래보고서 기록</h2>
                    <div class="date-navigator">
                        <button id="transactionPrevDate" class="btn btn-secondary btn-sm">◀</button>
                        <div id="transactionCurrentDate" class="date-display">2025-01-01</div>
                        <button id="transactionNextDate" class="btn btn-secondary btn-sm">▶</button>
                    </div>
                    <div id="transactionRecordsList"></div>
                </div>
            </div>

            <!-- RP보고서 탭 -->
            <div id="rp" class="tab-content">
                <div class="card">
                    <h2>RP보고서 작성</h2>
                    <form id="rpForm">
                        <div class="form-group">
                            <label for="rpDate">작성 날짜</label>
                            <input type="text" id="rpDate" readonly>
                            <small>보고서 작성 날짜가 자동으로 기록됩니다</small>
                        </div>
                        <div class="form-group">
                            <label for="rpItem">항목</label>
                            <select id="rpItem" required>
                                <option value="">항목을 선택하세요</option>
                                <option value="범죄">범죄</option>
                                <option value="일반">일반</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="rpCount">개수</label>
                            <select id="rpCount">
                                <option value="1" selected>1개</option>
                                <option value="2">2개</option>
                                <option value="3">3개</option>
                                <option value="4">4개</option>
                                <option value="5">5개</option>
                                <option value="6">6개</option>
                                <option value="7">7개</option>
                                <option value="8">8개</option>
                                <option value="9">9개</option>
                                <option value="10">10개</option>
                            </select>
                            <small>선택한 개수만큼 개별 건으로 기록됩니다</small>
                        </div>
                        <div class="form-group">
                            <label for="rpAmount">금액</label>
                            <input type="text" id="rpAmount" readonly>
                            <small>항목 선택 시 자동으로 계산됩니다</small>
                        </div>
                        <div class="form-group">
                            <label for="rpContent">특이사항 (선택사항)</label>
                            <textarea id="rpContent" rows="4" placeholder="특이사항을 입력하세요"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">RP보고서 저장</button>
                        <div id="rpStatus" class="status-message"></div>
                    </form>
                </div>
                
                <div class="card">
                    <h2>내 RP보고서 기록</h2>
                    <div class="date-navigator">
                        <button id="rpPrevDate" class="btn btn-secondary btn-sm">◀</button>
                        <div id="rpCurrentDate" class="date-display">2025-01-01</div>
                        <button id="rpNextDate" class="btn btn-secondary btn-sm">▶</button>
                    </div>
                    <div id="rpRecordsList"></div>
                </div>
            </div>

            <!-- 지원권 탭 -->
            <div id="voucher" class="tab-content">
                <div class="card">
                    <h2>🎫 내 지원권 현황</h2>
                    <p class="voucher-reset-info">매달 1일에 초기화됩니다</p>
                    <div id="voucherStatus" class="voucher-status">
                        <!-- 사용 현황 -->
                    </div>
                    <div class="voucher-use-section">
                        <div class="form-group">
                            <label for="voucherSelect">지원권 선택</label>
                            <select id="voucherSelect">
                                <option value="">지원권을 선택하세요</option>
                            </select>
                        </div>
                        <button id="useVoucherBtn" class="btn btn-primary">지원권 사용</button>
                    </div>
                </div>
                
                <div class="card">
                    <h2>📜 사용 내역</h2>
                    <div id="voucherHistory"></div>
                </div>
            </div>

            <!-- 조직도 탭 -->
            <div id="orgchart" class="tab-content">
                <div class="card">
                    <h2>🏢 조직도</h2>
                    <div id="orgChartContainer" class="org-chart">
                        <!-- 조직도가 여기에 표시됩니다 -->
                    </div>
                </div>
            </div>

            <!-- 이벤트 탭 -->
            <div id="event" class="tab-content">
                <div class="card">
                    <h2>🎉 이벤트</h2>
                    <form id="eventPurchaseForm">
                        <div class="form-group">
                            <label for="eventItem">이벤트 항목</label>
                            <select id="eventItem" required>
                                <option value="">항목을 선택하세요</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>총 금액</label>
                            <input type="text" id="eventTotalAmount" readonly>
                        </div>
                        <div class="form-group">
                            <label for="eventDetail">상세 내역 (선택사항)</label>
                            <textarea id="eventDetail" rows="6" placeholder="상세 내역을 입력하세요">기간 : 

참가이벤트 :

역할 :</textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">참여</button>
                        <div id="eventPurchaseStatus" class="status-message"></div>
                    </form>
                </div>
                
                <div class="card">
                    <h2>📜 참여 내역</h2>
                    <div id="eventHistory"></div>
                </div>
            </div>

            <!-- 검색 탭 -->
            <div id="search" class="tab-content">
                <div class="card">
                    <h2>🔍 보고서 검색</h2>
                    <form id="searchReportForm">
                        <div class="form-group">
                            <label for="searchReportType">보고서 유형</label>
                            <select id="searchReportType">
                                <option value="">전체</option>
                                <option value="거래">거래보고서</option>
                                <option value="RP">RP보고서</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <label for="searchStartDate">시작 날짜</label>
                                <input type="date" id="searchStartDate">
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label for="searchEndDate">종료 날짜</label>
                                <input type="date" id="searchEndDate">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="searchWriterUid">작성자 고유번호</label>
                            <input type="text" id="searchWriterUid" placeholder="작성자 고유번호 (선택사항)">
                        </div>
                        <div class="form-group">
                            <label for="searchItem">항목</label>
                            <input type="text" id="searchItem" placeholder="항목 (선택사항)">
                        </div>
                        <div class="form-group">
                            <label for="searchKeyword">키워드</label>
                            <input type="text" id="searchKeyword" placeholder="내용 검색 (선택사항)">
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="btn btn-primary">검색</button>
                            <button type="button" id="clearSearchBtn" class="btn btn-secondary">초기화</button>
                        </div>
                    </form>
                    <div id="searchStatus" class="status-message" style="margin-top: 15px;"></div>
                    <div id="searchResults" style="margin-top: 20px;"></div>
                </div>
            </div>

            <!-- 통계 탭 (고위직만) -->
            <div id="statistics" class="tab-content">
                <div class="card">
                    <h2>📊 사용자 통계</h2>
                    <div class="form-group">
                        <label>조회 주</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <button class="btn btn-sm btn-secondary" id="statisticsPrevWeekBtn">←</button>
                            <span id="statisticsWeekInfo" style="font-weight: bold; min-width: 150px; text-align: center;"></span>
                            <button class="btn btn-sm btn-secondary" id="statisticsNextWeekBtn">→</button>
                        </div>
                    </div>
                    <div id="statisticsUserList" style="margin-top: 20px;"></div>
                </div>
            </div>

            <!-- 관리 탭 (관리자만) -->
            <div id="admin" class="tab-content">
                <div class="card">
                    <h2>⚙️ 관리자 페이지</h2>
                    
                    <!-- 승인 대기 사용자 -->
                    <div class="admin-section">
                        <h3>승인 대기 사용자</h3>
                        <div id="pendingUsers" class="pending-users-list">
                            <!-- 승인 대기 사용자 목록 -->
                        </div>
                    </div>
                    
                    <!-- 사용자 권한 관리 -->
                    <div class="admin-section">
                        <h3>사용자 권한 관리</h3>
                        <div id="userRoleManagement">
                            <!-- 권한 관리 목록 -->
                        </div>
                    </div>
                    
                    <!-- 주급 내보내기 -->
                    <div class="admin-section">
                        <h3>주급 관리</h3>
                        <div id="weeklyPayWeekDisplay" style="margin-bottom: 15px;"></div>
                        <button id="exportWeeklyPayBtn" class="btn btn-primary">주급 내보내기</button>
                        <div id="weeklyPayExportStatus" class="status-message" style="margin-top: 10px;"></div>
                    </div>
                    
                    <!-- 거래 항목 관리 -->
                    <div class="admin-section">
                        <h3>거래 항목 관리</h3>
                        <div id="transactionItemsList" class="items-list" style="margin-bottom: 15px;"></div>
                        <div class="form-group">
                            <label>새 거래 항목 추가</label>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                <input type="text" id="newTransactionItem" placeholder="항목 이름" style="flex: 1; min-width: 120px;">
                                <input type="number" id="newTransactionItemAmount" placeholder="금액" style="width: 100px;">
                                <input type="number" id="newTransactionItemPublicDeposit" placeholder="공금입금액" style="width: 110px;" min="0">
                                <input type="number" id="newTransactionItemLimit" placeholder="개수제한 (0=무제한)" style="width: 140px;" min="0">
                                <button id="addTransactionItemBtn" class="btn btn-primary btn-sm">추가</button>
                            </div>
                        </div>
                        <div id="transactionItemsStatus" class="status-message"></div>
                    </div>
                    
                    <!-- 지원권 관리 -->
                    <div class="admin-section">
                        <h3>지원권 관리</h3>
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label for="voucherMaxCount">월 최대 사용 횟수 (사용자당)</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="number" id="voucherMaxCount" placeholder="5" min="1" style="width: 100px;">
                                <button id="saveVoucherMaxBtn" class="btn btn-primary btn-sm">저장</button>
                            </div>
                            <small>현재 설정: <span id="currentVoucherMax">-</span>회</small>
                        </div>
                        
                        <h4 style="margin-bottom: 10px;">사용자별 추가 횟수 부여</h4>
                        <form id="addBonusVoucherForm" style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                            <input type="text" id="bonusVoucherUid" placeholder="고유번호" style="width: 120px;">
                            <input type="number" id="bonusVoucherCount" placeholder="추가 횟수" min="1" style="width: 100px;">
                            <button type="submit" class="btn btn-primary btn-sm">부여</button>
                        </form>
                        <div id="bonusVoucherWeekDisplay" style="margin-bottom: 10px;"></div>
                        <div id="bonusVoucherList"></div>
                        
                        <h4 style="margin-top: 20px; margin-bottom: 10px;">지원권 항목</h4>
                        <form id="addVoucherTypeForm" style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                            <input type="text" id="newVoucherName" placeholder="지원권 이름" style="flex: 1; min-width: 150px;">
                            <button type="submit" class="btn btn-primary btn-sm">추가</button>
                        </form>
                        <div id="voucherTypesList"></div>
                    </div>
                    
                    <!-- 이벤트 항목 관리 -->
                    <div class="admin-section">
                        <h3>이벤트 항목 관리</h3>
                        <div id="eventItemsList" class="items-list" style="margin-bottom: 15px;"></div>
                        <form id="addEventItemForm" style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                            <input type="text" id="newEventItemName" placeholder="항목 이름" style="flex: 1; min-width: 150px;">
                            <input type="number" id="newEventItemPrice" placeholder="금액" style="width: 100px;">
                            <input type="number" id="newEventItemQuantity" placeholder="개수" min="1" style="width: 100px;">
                            <button type="submit" class="btn btn-primary btn-sm">추가</button>
                        </form>
                        <div id="eventItemsStatus" class="status-message"></div>
                    </div>
                    
                    <!-- RP 항목 관리 -->
                    <div class="admin-section">
                        <h3>RP 항목 관리</h3>
                        <form id="addRpItemForm" style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                            <input type="text" id="newRpItemName" placeholder="항목 이름" style="flex: 1; min-width: 150px;">
                            <input type="number" id="newRpItemPrice" placeholder="금액" style="width: 100px;">
                            <button type="submit" class="btn btn-primary btn-sm">추가</button>
                        </form>
                        <div id="rpItemsList"></div>
                    </div>
                    
                    <!-- 조직도 관리 -->
                    <div class="admin-section">
                        <h3>조직도 관리</h3>
                        <form id="addOrgMemberForm" class="org-member-form">
                            <div class="form-row">
                                <div class="form-group" style="flex: 1;">
                                    <label for="orgMemberName">이름</label>
                                    <input type="text" id="orgMemberName" placeholder="이름" required>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label for="orgMemberPosition">직급</label>
                                    <select id="orgMemberPosition" required>
                                        <option value="">직급 선택</option>
                                        <option value="고위직">고위직</option>
                                        <option value="간부직">간부직</option>
                                        <option value="일반직">일반직</option>
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label for="orgMemberTitle">직책</label>
                                    <input type="text" id="orgMemberTitle" placeholder="예: 대표, 팀장">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group" style="flex: 1;">
                                    <label for="orgMemberImage">프로필 이미지 URL</label>
                                    <input type="text" id="orgMemberImage" placeholder="이미지 URL (비워두면 기본 이미지)">
                                </div>
                                <div class="form-group" style="width: 100px;">
                                    <label for="orgMemberOrder">순서</label>
                                    <input type="number" id="orgMemberOrder" placeholder="1" min="1" value="1">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">멤버 추가</button>
                        </form>
                        <div id="orgMembersList" style="margin-top: 20px;"></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- 푸터 -->
        <footer class="footer">
            <p>&copy; 2025 Joy Enter. All rights reserved.</p>
        </footer>
    </div>

    <!-- 스크립트 -->
    <script type="module" src="script.js"></script>
</body>
</html>
